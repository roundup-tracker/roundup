<tal:block metal:use-macro="templates/page/macros/icing">
<title metal:fill-slot="head_title">Issue searching</title>
<td class="page-header-top" metal:fill-slot="body_title">
 <h2>Issue searching</h2>
</td>
<td class="content" metal:fill-slot="content">

<form method="GET" tal:attributes="action request/classname">

<table class="form" tal:define="
   cols python:request.columns or 'id activity title status assignedto'.split();
   sort_on python:request.sort[1] or 'activity';
   group_on python:request.group[1] or 'priority';

   search_input templates/page/macros/search_input;
   column_input templates/page/macros/column_input;
   sort_input templates/page/macros/sort_input;
   group_input templates/page/macros/group_input;
   search_select templates/page/macros/search_select;">

<tr>
 <th class="header">&nbsp;</th>
 <th class="header">Filter on</th>
 <th class="header">Display</th>
 <th class="header">Sort on</th>
 <th class="header">Group on</th>
</tr>

<tr tal:define="name string:@search_text">
  <th>All text*:</th>
  <td metal:use-macro="search_input"></td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
  <td>&nbsp;</td>
</tr>

<tr tal:define="name string:title">
  <th>Title:</th>
  <td metal:use-macro="search_input"></td>
  <td metal:use-macro="column_input"></td>
  <td metal:use-macro="sort_input"></td>
  <td>&nbsp;</td>
</tr>

<tr tal:define="name string:topic;
                db_klass string:keyword;
                db_content string:name;">
  <th>Topic:</th>
  <td metal:use-macro="search_select"></td>
  <td metal:use-macro="column_input"></td>
  <td metal:use-macro="sort_input"></td>
  <td metal:use-macro="group_input"></td>
</tr>

<tr tal:define="name string:id">
  <th>ID:</th>
  <td metal:use-macro="search_input"></td>
  <td metal:use-macro="column_input"></td>
  <td metal:use-macro="sort_input"></td>
  <td>&nbsp;</td>
</tr>

<tr tal:define="name string:creation">
  <th>Creation Date:</th>
  <td metal:use-macro="search_input"></td>
  <td metal:use-macro="column_input"></td>
  <td metal:use-macro="sort_input"></td>
  <td metal:use-macro="group_input"></td>
</tr>

<tr tal:define="name string:creator;
                db_klass string:user;
                db_content string:username;">
  <th>Creator:</th>
  <td metal:use-macro="search_select">
    <option metal:fill-slot="extra_options"
            tal:attributes="value request/user/id">created by me</option>
  </td>
  <td metal:use-macro="column_input"></td>
  <td metal:use-macro="sort_input"></td>
  <td metal:use-macro="group_input"></td>
</tr>

<tr tal:define="name string:activity">
  <th>Activity:</th>
  <td metal:use-macro="search_input"></td>
  <td metal:use-macro="column_input"></td>
  <td metal:use-macro="sort_input"></td>
  <td>&nbsp;</td>
</tr>

<tr tal:define="name string:priority;
                db_klass string:priority;
                db_content string:name;">
  <th>Priority:</th>
  <td metal:use-macro="search_select">
    <option metal:fill-slot="extra_options" value="-1"
            tal:attributes="selected python:value == '-1'">not selected</option>
  </td>
  <td metal:use-macro="column_input"></td>
  <td metal:use-macro="sort_input"></td>
  <td metal:use-macro="group_input"></td>
</tr>

<tr tal:define="name string:status;
                db_klass string:status;
                db_content string:name;">
  <th>Status:</th>
  <td metal:use-macro="search_select">
    <tal:block metal:fill-slot="extra_options">
      <option value="-1,1,2,3,4,5,6,7"
              tal:attributes="selected python:value == '-1,1,2,3,4,5,6,7'">not resolved</option>
      <option value="-1"
              tal:attributes="selected python:value == '-1'">not selected</option>
    </tal:block>    
  </td>
  <td metal:use-macro="column_input"></td>
  <td metal:use-macro="sort_input"></td>
  <td metal:use-macro="group_input"></td>
</tr>

<tr tal:define="name string:assignedto;
                db_klass string:user;
                db_content string:username;">
  <th>Assigned to:</th>
  <td metal:use-macro="search_select">
    <tal:block metal:fill-slot="extra_options">
      <option tal:attributes="value request/user/id">assigned to me</option>
      <option value="-1" tal:attributes="selected python:value == '-1'">unassigned</option>
    </tal:block>
  </td>
  <td metal:use-macro="column_input"></td>
  <td metal:use-macro="sort_input"></td>
  <td metal:use-macro="group_input"></td>
</tr>

<tr>
<th>Pagesize:</th>
<td><input name="@pagesize" size="3" value="50"
           tal:attributes="value request/form/@pagesize/value | default"></td>
</tr>

<tr>
<th>Start With:</th>
<td><input name="@startwith" size="3" value="0"
           tal:attributes="value request/form/@startwith/value | default"></td>
</tr>

<tr>
<th>Sort Descending:</th>
<td><input type="checkbox" name="@sortdir"
           tal:attributes="checked python:request.sort[0] == '-' or request.sort[0] is None">
</td>
</tr>

<tr>
<th>Group Descending:</th>
<td><input type="checkbox" name="@groupdir"
           tal:attributes="checked python:request.group[0] == '-'">
</td>
</tr>

<tr>
<th>Query name**:</th>
<td><input name="@queryname"
           tal:attributes="value request/form/@queryname/value | default"></td>
</tr>

<tr>
  <td>
   &nbsp;
   <input type="hidden" name="@action" value="search">
  </td>
  <td><input type="submit" value="Search"></td>
</tr>

<tr><td>&nbsp;</td>
 <td colspan="4" class="help">
   *: The "all text" field will look in message bodies and issue titles<br>
   **: If you supply a name, the query will be saved off and available as a
       link in the sidebar
 </td>
</tr>
</table>

</form>
</td>

</tal:block>
